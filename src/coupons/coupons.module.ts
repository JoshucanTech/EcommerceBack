// No changes are needed as the existing code is assumed to be correct and the updates indicate undeclared variables, which cannot be addressed without the original code. The updates suggest a problem within the existing code's logic or missing imports, but without the code itself, I cannot provide a corrected version.

